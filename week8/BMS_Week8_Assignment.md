# 기초의학통계 8주차 실습 과제 정리
범주형 자료분석 I — 카이제곱 및 Fisher 검정  
작성자: 김도연  
데이터 출처: HTN.csv / sample_1500.csv  
분석 도구: R 4.3.2

---

## 문제 1. 음주 여부와 당뇨병 이환 간의 관련성

### 문제 요약
아래 교차표를 보고 기대빈도를 직접 계산하시오.

|        | 당뇨(-) | 당뇨(+) | 합계 |
|--------|--------:|--------:|-----:|
| 음주(-) | 18 | 12 | 30 |
| 음주(+) | 10 | 20 | 30 |
| 합계 | 28 | 32 | 60 |

### 기대빈도 계산식
각 셀의 기대빈도 E_ij는 다음과 같다.

E_ij = (행의 합 × 열의 합) / 전체 합

### 계산 결과
| 셀 | 계산식 | 결과 |
|----|--------|-----:|
| A (음주(-), 당뇨(-)) | (30 × 28) / 60 | 14 |
| B (음주(-), 당뇨(+)) | (30 × 32) / 60 | 16 |
| C (음주(+), 당뇨(-)) | (30 × 28) / 60 | 14 |
| D (음주(+), 당뇨(+)) | (30 × 32) / 60 | 16 |

### 관찰빈도 / 기대빈도 표
|        | 당뇨(-) | 당뇨(+) | 합계 |
|--------|--------:|--------:|-----:|
| 음주(-) | 18 / 14 | 12 / 16 | 30 |
| 음주(+) | 10 / 14 | 20 / 16 | 30 |
| 합계 | 28 | 32 | 60 |

요약: 기대빈도는 주변합을 이용해 (행합 × 열합) / 전체합으로 계산하며, 이는 귀무가설(독립) 하에 기대되는 도수이다.

---

## 문제 2. 음주 여부와 고혈압(HTN) 이환의 관련성

### 가설
- H0: 음주 여부와 고혈압 이환은 서로 독립이다.
- H1: 서로 독립이 아니다.

### 교차표 (관찰 / 기대)
|        | HTN(-) | HTN(+) | 합계 |
|--------|-------:|-------:|-----:|
| 음주(-) | 77 / 74.88 | 19 / 21.12 | 96 |
| 음주(+) | 79 / 81.12 | 25 / 22.88 | 104 |
| 합계 | 156 | 44 | 200 |

### 검정 선택 및 p-value
- 선택: 카이제곱 검정 (모든 기대빈도 ≥ 5이므로 근사 적용 가능)
- p-value: 0.4689

---

## 문제 3. 흡연 여부와 폐암(lung_cancer) 이환의 관련성

### 가설
- H0: 흡연 여부와 폐암 이환은 서로 독립이다.
- H1: 서로 독립이 아니다.

### 교차표 (관찰 / 기대)
|        | 폐암(-) | 폐암(+) | 합계 |
|--------|-------:|-------:|-----:|
| 비흡연 | 923 / 917.95 | 3 / 8.05 | 926 |
| 흡연 | 560 / 565.05 | 10 / 4.95 | 570 |
| 합계 | 1483 | 13 | 1496 |

### 검정 선택 및 p-value
- 선택: Fisher의 정확성 검정 (기대빈도 < 5인 셀이 존재)
- p-value: 0.00691

---

## 부록: 검정 선택 기준 요약

| 검정 | 적용 조건 | R 함수 |
|------|-----------|--------|
| 카이제곱 검정 | 모든 기대빈도 ≥ 5 | `chisq.test()` |
| Yates 보정 χ² | 2×2 표에서 근사 수정 필요시 | `chisq.test(..., correct=TRUE)` |
| Fisher 정확성 검정 | 기대빈도 < 5 셀 존재 | `fisher.test()` |
